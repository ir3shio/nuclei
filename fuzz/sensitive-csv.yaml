id: sensitive-csv

info:
  name: Sensitive CSV file Detect
  author: omkar7505
  severity: high
  description: Template detects potential Sensitive CSV file exposed
  tags: omkar7505,cache

  
http:
  - method: GET
    path:
      - "{{BaseURL}}/storage/doesnotexist.csv"
      - "{{BaseURL}}/storage/users.csv"
      - "{{BaseURL}}/storage/orders.csv"
      - "{{BaseURL}}/storage/transactions.csv"
      - "{{BaseURL}}/storage/reports.csv"
      - "{{BaseURL}}/storage/customers.csv"
      - "{{BaseURL}}/storage/backups/users_backup.csv"
      - "{{BaseURL}}/storage/tables/profiles.csv"
      - "{{BaseURL}}/storage/tables/roles.csv"
      - "{{BaseURL}}/storage/tables/invoices.csv"

    stop-at-first-match: true
    matchers:
      - type: dsl
        dsl:
          - "status_code_1 != 200 && status_code_2 == 200"
          - "status_code_1 != 200 && status_code_3 == 200"
          - "status_code_1 != 200 && status_code_4 == 200"
          - "status_code_1 != 200 && status_code_5 == 200"
          - "status_code_1 != 200 && status_code_6 == 200"
          - "status_code_1 != 200 && status_code_7 == 200"
          - "status_code_1 != 200 && status_code_8 == 200"
          - "status_code_1 != 200 && status_code_9 == 200"
          - "status_code_1 != 200 && status_code_10 == 200"
        condition: or
