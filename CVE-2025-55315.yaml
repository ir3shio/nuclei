id: CVE-2025-55315

info:
  name: ASP.NET Kestrel HTTP Request Smuggling Vulnerability
  author: @amitlt2 & @viehgroup
  severity: Critical
  description: Detection for CVE-2025-55315 - Critical HTTP request/response smuggling vulnerability in ASP.NET Kestrel webserver
  reference:
    - https://github.com/dotnet/aspnetcore/commit/
    - https://nvd.nist.gov/vuln/detail/CVE-2025-55315
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.9
    cve-id: CVE-2025-55315
  tags: cve,cve2025,http,kestrel,aspnet,dotnet,smuggling

http:
  - method: GET
    path:
      - "{{BaseURL}}"
    
    headers:
      Host: "{{Hostname}}"
      Transfer-Encoding: chunked
      Content-Type: text/plain
      Connection: keep-alive
    
    body: "2;\rxx\r\nxy\r\n0\r\n\r\n"
    
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "HTTP/1.1 200 OK"
          - "ASP.NET"
        condition: or
        part: header

      - type: word
        words:
          - "Kestrel"
        part: body

  - method: POST
    path:
      - "{{BaseURL}}"
    
    headers:
      Host: "{{Hostname}}"
      Transfer-Encoding: chunked
      Content-Type: text/plain
    
    body: "2;\rxx\r\nxy\r\n0\r\n\r\n"
    
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 415

      - type: word
        words:
          - "HTTP/1.1"
        part: header

  - method: POST
    path:
      - "{{BaseURL}}/ct"
    
    headers:
      Host: "{{Hostname}}"
      Transfer-Encoding: chunked
      Content-Type: text/plain
    
    body: "2;\rxx\r\nxy\r\n0\r\n\r\n"
    
    matchers:
      - type: status
        status:
          - 415
          - 200

  - method: GET
    path:
      - "{{BaseURL}}"
    
    headers:
      Host: "{{Hostname}}"
      Transfer-Encoding: chunked
      Content-Type: text/plain
    
    body: "2;\rxx\r\nxy\r\n0\r\n\r\n"
    
    matchers:
      - type: dsl
        dsl:
          - "status_code == 200 && contains(all_headers, 'Kestrel')"
          - "status_code == 200 && contains(body, 'ASP.NET')"
