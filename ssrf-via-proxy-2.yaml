id: ssrf-via-proxy-2

info:
  name: SSRF via Proxy Unsafe
  author: geeknik,petergrifin
  severity: unknown
  reference:
    - https://github.com/geeknik/the-nuclei-templates/blob/main/ssrf-by-proxy.yaml
    - https://twitter.com/HusseiN98D/status/1649006265450782720
    - https://twitter.com/ImoJOnDz/status/1649089777629827072
  metadata:
    max-request: 9
  tags: ssrf,proxy,oast,fuzzing

http:
    raw:
      - |+
        GET http://{{interactsh-url}} HTTP/1.1
        Host: {{Hostname}}

    unsafe: true

    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
